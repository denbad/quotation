version: "3"

services:
    cli:
        container_name: quotation-cli
        depends_on:
            - db
        links:
            - db:mysql
        build:
            context: .
            dockerfile: .docker/cli/Dockerfile
        volumes:
            - .:/app

    db:
        container_name: quotation-db
        image: percona:8.0.19-10
        ports:
            - 13306:3306
        env_file:
            - .docker.env.prod
        volumes:
            - ./.docker-volumes/db:/var/lib/mysql

    server:
        container_name: quotation-server
        depends_on:
            - db
        links:
            - db:mysql
        build:
            context: .
            dockerfile: .docker/server/Dockerfile
        ports:
            - 8000:8000
        volumes:
            - .:/app
